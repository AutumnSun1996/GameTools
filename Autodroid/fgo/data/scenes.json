{
  "地图选择": {
    "Name": "地图选择",
    "Condition": ["$all", [["右下-菜单"], ["左上-管理室"], ["下一个"]]],
    "Actions": [
      {"Type": "Click", "Target": "下一个"},
      {"Type": "Wait", "Time": 1}
    ],
    "Next": ["关卡选择"]
  },
  "关卡选择": {
    "Name": "关卡选择",
    "Condition": ["$all", [["右下-菜单"], ["左上-关闭"]]],
    "Actions": [
      {"Type": "Click", "Target": "默认关卡"},
      {"Type": "Wait", "Time": 1}
    ],
    "Next": ["助战选择", "AP不足", "关卡选择"]
  },
  "AP不足": {
    "Name": "AP不足",
    "Condition": ["AP不足"],
    "Actions": [
      {
        "Type": "Click",
        "Condition": ["$method", "resource_in_screen", "银苹果不足"],
        "Target": "金苹果"
      },
      {
        "Type": "Click",
        "Condition": [
          "$not_",
          ["$method", "resource_in_screen", "银苹果不足"]
        ],
        "Target": "银苹果"
      },
      {"Type": "Wait", "Time": 1},
      {"Type": "Click", "Target": "补充AP-决定"},
      {"Type": "Wait", "Time": 1}
    ],
    "Next": ["助战选择"]
  },
  "获得物品": {
    "Name": "获得物品",
    "Condition": ["获得物品"],
    "Actions": [
      {"Type": "Wait", "Time": 1},
      {"Type": "InnerCall", "Target": "make_screen_shot"},
      {"Type": "InnerCall", "Target": "save_record"},
      {"Type": "InnerCall", "Target": "reset_combat_info"},
      {"Type": "Click", "Target": "下一步"},
      {"Type": "Wait", "Time": 1}
    ],
    "Next": [
      "获得物品",
      "地图选择",
      "关卡选择",
      "任务奖励",
      "申请好友",
      "剧情"
    ]
  },
  "申请好友": {
    "Name": "申请好友",
    "Condition": ["申请好友"],
    "Actions": [
      {"Type": "Click", "Target": "申请好友"},
      {"Type": "Wait", "Time": 1}
    ],
    "Next": [
      "好友申请失败",
      "地图选择",
      "关卡选择",
      "任务奖励",
      "剧情",
      "申请好友"
    ]
  },
  "好友申请失败": {
    "Name": "好友申请失败",
    "Condition": ["好友申请失败-关闭"],
    "Actions": [
      {"Type": "Click", "Target": "好友申请失败-关闭"},
      {"Type": "Wait", "Time": 1}
    ],
    "Next": ["地图选择", "关卡选择", "任务奖励", "剧情"]
  },
  "任务奖励": {
    "Name": "任务奖励",
    "Condition": ["任务奖励"],
    "Actions": [
      {"Type": "Click", "Target": "任务奖励"},
      {"Type": "Wait", "Time": 1}
    ],
    "Next": ["地图选择", "关卡选择", "任务奖励", "剧情"]
  },
  "队伍确认": {
    "Name": "队伍确认",
    "Condition": ["队伍确认"],
    "Actions": [
      {"Type": "Click", "Target": "开始任务"},
      {"Type": "Wait", "Time": 1}
    ],
    "Next": ["加载关卡", "选择技能", "队伍确认", "剧情"]
  },
  "加载关卡": {
    "Name": "加载关卡",
    "Condition": ["加载提示"],
    "Actions": [{"Type": "Wait", "Time": 1}],
    "Next": ["加载关卡", "选择技能", "剧情"]
  },
  "剧情": {
    "Name": "剧情",
    "Condition": ["剧情-对话框"],
    "Actions": [
      {"Type": "Click", "Target": "剧情-跳过"},
      {"Type": "Wait", "Time": 1},
      {"Type": "Click", "Target": "剧情-确认跳过"},
      {"Type": "Wait", "Time": 3}
    ],
    "Next": [
      "加载关卡",
      "选择技能",
      "剧情",
      "任务奖励",
      "地图选择",
      "关卡选择"
    ]
  },
  "助战选择": {
    "Name": "助战选择",
    "Condition": ["$all", [["助战选择"], ["$not_", ["助战更新失败"]]]],
    "Actions": [
      {"Type": "InnerCall", "Target": "choose_assist_servant"},
      {"Type": "Wait", "Time": 1}
    ],
    "Next": ["队伍确认", "助战选择", "助战更新失败"]
  },
  "助战更新失败": {
    "Name": "助战更新失败",
    "Condition": ["助战更新失败"],
    "Actions": [
      {"Type": "Click", "Target": "助战更新失败-关闭"},
      {"Type": "Wait", "Time": 2}
    ],
    "Next": ["助战选择"]
  },
  "选择技能": {
    "Name": "选择技能",
    "Condition": ["战斗菜单"],
    "Actions": [
      {
        "Type": "MultiActions",
        "Condition": ["$getattr", ["$"], "scene_changed"],
        "Actions": [
          {"Type": "Wait", "Time": 3},
          {"Type": "InnerCall", "Target": "extract_combat_info"},
          {"Type": "InnerCall", "Target": "choose_skills"},
          {"Type": "Wait", "Time": 1}
        ]
      },
      {"Type": "Click", "Target": "Attack"},
      {"Type": "Wait", "Time": 3}
    ],
    "Next": ["选择指令卡", "选择技能"]
  },
  "选择指令卡": {
    "Name": "选择指令卡",
    "Condition": ["战斗速度"],
    "Actions": [
      {"Type": "InnerCall", "Target": "choose_cards"},
      {"Type": "Wait", "Time": 5}
    ],
    "Next": ["选择技能", "获得羁绊", "战斗失败"]
  },
  "战斗失败": {
    "Name": "战斗失败",
    "Condition": ["续关"],
    "Actions": [
      {"Type": "InnerCall", "Target": "error", "args": ["战斗失败"]},
      {"Type": "Click", "Target": "续关-撤退"},
      {"Type": "Wait", "Time": 0.5},
      {"Type": "Click", "Target": "撤退-决定"},
      {"Type": "Wait", "Time": 0.5},
      {"Type": "Click", "Target": "撤退-关闭"},
      {"Type": "Wait", "Time": 0.5}
    ],
    "Next": ["地图选择", "关卡选择", "申请好友"]
  },
  "获得羁绊": {
    "Name": "获得羁绊",
    "Condition": ["与从者的羁绊"],
    "Actions": [
      {"Type": "Click", "Target": "下一步"},
      {"Type": "Wait", "Time": 0.5}
    ],
    "Next": ["获得羁绊", "获得经验", "羁绊加深", "获得羁绊礼装"]
  },
  "获得羁绊礼装": {
    "Name": "获得羁绊礼装",
    "Condition": ["获得羁绊礼装"],
    "Actions": [
      {
        "Type": "InnerCall",
        "Target": "save_record",
        "args": ["获得羁绊礼装"]
      },
      {"Type": "InnerCall", "Target": "error", "args": ["获得羁绊礼装"]},
      {"Type": "Click", "Target": "点击画面"},
      {"Type": "Wait", "Time": 0.5},
      {
        "Type": "InnerCall",
        "Target": "save_record",
        "args": ["获得羁绊礼装"]
      },
      {"Type": "Click", "Target": "羁绊礼装-关闭"},
      {"Type": "Wait", "Time": 0.5}
    ],
    "Next": ["获得羁绊", "获得经验", "羁绊加深", "获得羁绊礼装"]
  },
  "羁绊加深": {
    "Name": "羁绊加深",
    "Condition": ["羁绊加深"],
    "Actions": [
      {"Type": "Click", "Target": "下一步"},
      {"Type": "Wait", "Time": 0.5}
    ],
    "Next": ["羁绊加深", "获得经验"]
  },
  "获得经验": {
    "Name": "获得经验",
    "Condition": ["获得经验"],
    "Actions": [
      {"Type": "Click", "Target": "下一步"},
      {"Type": "Wait", "Time": 0.5}
    ],
    "Next": ["获得经验", "获得物品", "御主等级上升", "礼装等级上升"]
  },
  "御主等级上升": {
    "Name": "御主等级上升",
    "Condition": ["御主等级"],
    "Actions": [
      {"Type": "Click", "Target": "下一步"},
      {"Type": "Wait", "Time": 0.5}
    ],
    "Next": ["获得经验", "获得物品", "礼装等级上升"]
  },
  "礼装等级上升": {
    "Name": "礼装等级上升",
    "Condition": ["魔术礼装等级"],
    "Actions": [
      {"Type": "Click", "Target": "下一步"},
      {"Type": "Wait", "Time": 0.5}
    ],
    "Next": ["获得经验", "获得物品"]
  }
}